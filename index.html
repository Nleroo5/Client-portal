<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Launch Portal - Drive Lead Media</title>
    <style>
        /* ===== BASE STYLES ===== */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', system-ui, sans-serif;
            line-height: 1.6;
            color: #EEF4D9;
            background: linear-gradient(135deg, #012E40 0%, #05908C 100%);
            min-height: 100vh;
            position: relative;
        }

        .portal-container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* ===== HERO SECTION ===== */
        .hero {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 20px;
            background: linear-gradient(135deg, #05908C 0%, #85C7B3 100%);
            color: #012E40;
            border-radius: 14px;
            box-shadow: 0 4px 20px rgba(5, 144, 140, 0.3);
        }

        .hero h1 {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 12px;
            color: #012E40;
        }

        .hero p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 25px;
            max-width: 90ch;
            margin-left: auto;
            margin-right: auto;
            color: #012E40;
        }

        /* ===== STEP STYLES ===== */
        .step {
            background: #EEF4D9;
            border-radius: 14px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(5, 144, 140, 0.2);
            border: 2px solid #85C7B3;
            transition: all 0.3s ease;
        }

        .step.locked {
            opacity: 0.6;
            pointer-events: none;
            background: #EEF4D9;
        }

        .step.completed {
            border-color: #F2A922;
            background: #FBE9D1;
            box-shadow: 0 4px 20px rgba(242, 169, 34, 0.3);
        }

        .step-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            gap: 15px;
        }

        .step h2 {
            color: #012E40;
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .step-number {
            background: #05908C;
            color: #EEF4D9;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .step.completed .step-number {
            background: #F2A922;
            color: #012E40;
        }

        .step.locked .step-number {
            background: #85C7B3;
            color: #012E40;
        }

        .step-content {
            margin-bottom: 25px;
            color: #012E40;
        }

        .step-note {
            background: #DFF5F3;
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 0.95rem;
            color: #012E40;
            margin: 15px 0;
            border-left: 3px solid #05908C;
        }

        /* ===== BUTTONS ===== */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: #05908C;
            color: #EEF4D9;
            text-decoration: none;
            border-radius: 10px;
            font-weight: 600;
            font-size: 0.95rem;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            margin: 5px 5px 5px 0;
        }

        .btn:hover {
            background: #012E40;
            transform: translateY(-1px);
        }

        .btn:focus {
            outline: 2px solid #F2A922;
            outline-offset: 2px;
        }

        .btn-secondary {
            background: #F2A922;
            color: #012E40;
        }

        .btn-secondary:hover {
            background: #85C7B3;
        }

        .btn-outline {
            background: transparent;
            color: #05908C;
            border: 2px solid #05908C;
        }

        .btn-outline:hover {
            background: #05908C;
            color: #EEF4D9;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.85rem;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* ===== FORM ELEMENTS ===== */
        .form-group {
            margin: 15px 0;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #012E40;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #85C7B3;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: border-color 0.2s ease;
            background: rgba(238, 244, 217, 0.9);
            color: #012E40;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #F2A922;
            box-shadow: 0 0 0 3px rgba(242, 169, 34, 0.2);
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #012E40;
        }

        .radio-item input[type="radio"] {
            width: auto;
            margin: 0;
        }

        .checkbox-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin: 20px 0;
            cursor: pointer;
            color: #012E40;
        }

        .checkbox-item input[type="checkbox"] {
            width: auto;
            margin: 0;
            margin-top: 2px;
        }

        /* ===== SPECIAL SECTIONS ===== */
        .gallery-placeholder {
            background: #F0F9F7;
            border: 2px dashed #85C7B3;
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            margin: 20px 0;
            color: #012E40;
        }

        .success-message {
            background: linear-gradient(135deg, #F2A922 0%, #85C7B3 100%);
            color: #012E40;
            padding: 30px;
            border-radius: 14px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 4px 20px rgba(242, 169, 34, 0.3);
        }

        .success-message h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .brand-kit-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 15px;
        }

        /* ===== ADMIN STYLES ===== */
        .admin-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #F2A922;
            color: #012E40;
            border: 2px solid #012E40;
            padding: 12px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 700;
            z-index: 100000;
            box-shadow: 0 6px 20px rgba(242, 169, 34, 0.5);
            transition: all 0.2s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .admin-toggle:hover {
            background: #85C7B3;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(133, 199, 179, 0.5);
        }

        .admin-toggle:active {
            transform: translateY(0px);
        }

        .admin-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            background: #012E40;
            color: #EEF4D9;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            z-index: 99999;
            min-width: 320px;
            max-width: 400px;
            border: 2px solid #05908C;
            display: none;
        }

        .admin-panel h4 {
            margin: 0 0 20px 0; 
            font-size: 1.2rem;
            color: #F2A922;
            text-align: center;
            border-bottom: 1px solid #05908C;
            padding-bottom: 10px;
        }

        .admin-form input {
            width: 100%;
            margin-bottom: 12px;
            padding: 12px;
            border: 2px solid #85C7B3;
            border-radius: 8px;
            background: #EEF4D9;
            color: #012E40;
            font-size: 0.95rem;
        }

        .admin-form button {
            width: 100%;
            padding: 12px;
            background: #F2A922;
            color: #012E40;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 0.95rem;
            transition: all 0.2s ease;
        }

        .admin-form button:hover {
            background: #85C7B3;
            transform: translateY(-1px);
        }

        .admin-form button.danger {
            background: #ff6b6b;
            color: white;
        }

        .admin-form button.danger:hover {
            background: #ff5252;
        }

        .admin-form hr {
            margin: 20px 0;
            border: none;
            border-top: 1px solid #85C7B3;
        }

        .admin-status {
            font-size: 0.9rem;
            margin-top: 15px;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            display: none;
        }

        .admin-status.success {
            background: rgba(242, 169, 34, 0.2);
            color: #F2A922;
            border: 1px solid #F2A922;
        }

        .admin-status.error {
            background: rgba(255, 107, 107, 0.2);
            color: #ff6b6b;
            border: 1px solid #ff6b6b;
        }

        /* ===== FOOTER ===== */
        .portal-footer {
            text-align: center;
            padding: 30px 20px;
            margin-top: 40px;
            border-top: 2px solid rgba(133, 199, 179, 0.3);
            color: #EEF4D9;
            font-size: 0.9rem;
        }

        .portal-footer p {
            margin-bottom: 15px;
            color: #EEF4D9;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: #F2A922;
            text-decoration: none;
        }

        .footer-links a:hover {
            text-decoration: underline;
            color: #85C7B3;
        }

        .footer-links span {
            color: #85C7B3;
        }

        /* ===== SUPPORT MODE ===== */
        .skip-step {
            background: #F2A922;
            color: #012E40;
            font-size: 0.8rem;
            padding: 4px 12px;
            border-radius: 12px;
            margin-left: 10px;
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .portal-container {
                padding: 15px;
            }

            .hero {
                padding: 25px 15px;
            }

            .hero h1 {
                font-size: 1.8rem;
            }

            .step {
                padding: 20px;
            }

            .step-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .radio-group {
                flex-direction: column;
                gap: 10px;
            }

            .footer-links {
                flex-direction: column;
                gap: 10px;
            }

            .brand-kit-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .admin-toggle {
                top: 10px;
                right: 10px;
                padding: 8px 14px;
                font-size: 0.85rem;
            }

            .admin-panel {
                top: 60px;
                right: 10px;
                left: 10px;
                min-width: auto;
                max-width: none;
            }
        }

        @media (max-width: 360px) {
            .btn {
                width: 100%;
                justify-content: center;
                margin: 5px 0;
            }

            .hero h1 {
                font-size: 1.6rem;
            }
        }

        /* ===== ACCESSIBILITY ===== */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus styles */
        *:focus {
            outline: 2px solid #F2A922;
            outline-offset: 2px;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(242, 169, 34, 0.3);
        }
    </style>
</head>
<body>
    <!-- Admin Toggle Button -->
    <button class="admin-toggle" id="adminToggle" onclick="window.toggleAdminPanel()">ADMIN</button>
    
    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <h4>Admin Control Panel</h4>
        <div class="admin-form">
            <div id="adminLogin">
                <input type="password" id="adminPassword" placeholder="Enter admin password" autocomplete="new-password">
                <button id="loginBtn" onclick="window.adminLogin()">Login</button>
            </div>
            
            <div id="adminControls" style="display: none;">
                <input type="url" id="creativeLink" placeholder="Creative Preview Link (Google Drive, etc.)">
                <button id="setCreativeLink" onclick="window.setCreativeLink()">Set Creative Link</button>
                <button id="removeCreativeLink" class="danger" onclick="window.removeCreativeLink()">Remove Creative Link</button>
                
                <hr>
                
                <input type="url" id="stripePaymentLink" placeholder="Stripe Payment/Invoice Link">
                <button id="setStripeLink" onclick="window.setStripeLink()">Set Stripe Link</button>
                <button id="removeStripeLink" class="danger" onclick="window.removeStripeLink()">Remove Stripe Link</button>
            </div>
            
            <div id="adminStatus" class="admin-status"></div>
        </div>
    </div>

    <div class="portal-container">
        <!-- Hero Section -->
        <div class="hero">
            <h1>Client Launch Portal</h1>
            <p>Complete each step. We'll handle the rest.</p>
        </div>

        <!-- Success Message (hidden initially) -->
        <div class="success-message" id="successMessage" style="display: none;">
            <h3>üéâ Launch Complete!</h3>
            <p>All steps completed successfully. Your campaign will be live within 24-48 hours.</p>
        </div>

        <!-- Step 1: Sign Agreements -->
        <div class="step" id="step1">
            <div class="step-header">
                <div>
                    <h2>Sign Your Agreements</h2>
                    <div class="step-note">You'll receive copies automatically by email.</div>
                </div>
                <div class="step-number">1</div>
            </div>
            <div class="step-content">
                <div style="margin-bottom: 20px;">
                    <a href="#" class="btn" id="msaBtn" data-dlm-event="open_msa" target="_blank" rel="noopener">
                        Sign MSA
                    </a>
                    <a href="#" class="btn" id="dpaBtn" data-dlm-event="open_dpa" target="_blank" rel="noopener">
                        Sign DPA
                    </a>
                </div>
                <div class="radio-group">
                    <div class="radio-item">
                        <input type="radio" id="sow6" name="sowTerm" value="6" checked>
                        <label for="sow6">6-month term</label>
                    </div>
                    <div class="radio-item">
                        <input type="radio" id="sow12" name="sowTerm" value="12">
                        <label for="sow12">12-month term</label>
                    </div>
                </div>
                <a href="#" class="btn" id="sowBtn" data-dlm-event="open_sow" target="_blank" rel="noopener">
                    Sign SOW (6-month)
                </a>
            </div>
            <button class="btn btn-small skip-step" id="skip1" style="display: none;">Skip Step</button>
        </div>

        <!-- Step 2: Set Up Payment -->
        <div class="step locked" id="step2">
            <div class="step-header">
                <div>
                    <h2>Set Up Payment</h2>
                    <div class="step-note">Secure payment processing via Stripe. All major payment methods accepted.</div>
                </div>
                <div class="step-number">2</div>
            </div>
            <div class="step-content">
                <a href="#" class="btn" id="stripeBtn" data-dlm-event="open_stripe" target="_blank" rel="noopener">
                    Set Up Payment Method
                </a>
            </div>
            <button class="btn btn-small skip-step" id="skip2" style="display: none;">Skip Step</button>
        </div>

        <!-- Step 3: Meta Access & Brand Kit -->
        <div class="step locked" id="step3">
            <div class="step-header">
                <div>
                    <h2>Meta Access & Brand Kit</h2>
                </div>
                <div class="step-number">3</div>
            </div>
            <div class="step-content">
                <!-- Meta Business Suite Check -->
                <div style="margin-bottom: 25px;">
                    <h4 style="color: #012E40; margin-bottom: 15px;">Meta Business Suite Setup</h4>
                    <p style="color: #012E40; margin-bottom: 15px;">We need admin access to manage your ads and tracking. First, let us know your setup:</p>
                    
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="hasBusinessSuite" name="metaSetup" value="yes">
                            <label for="hasBusinessSuite">Yes, I have Meta Business Suite set up</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="noBusinessSuite" name="metaSetup" value="no">
                            <label for="noBusinessSuite">No, I don't have Meta Business Suite</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="unsureBusinessSuite" name="metaSetup" value="unsure">
                            <label for="unsureBusinessSuite">I'm not sure</label>
                        </div>
                    </div>
                </div>

                <!-- Instructions for existing Business Suite users -->
                <div id="existingBusinessSuite" style="display: none; background: #DFF5F3; padding: 20px; border-radius: 8px; margin: 15px 0; border: 1px solid #85C7B3;">
                    <h5 style="color: #012E40; margin-bottom: 15px;">How to Grant Drive Lead Media Access to Your Meta Business Suite</h5>
                    
                    <div style="color: #012E40; line-height: 1.6;">
                        <p style="margin-bottom: 12px;"><strong>Step 1: Open Meta Business Suite</strong><br>
                        Go to business.facebook.com and log in with your Facebook account</p>
                        
                        <p style="margin-bottom: 12px;"><strong>Step 2: Access Business Settings</strong><br>
                        Click "Business Settings" in the top menu</p>
                        
                        <p style="margin-bottom: 12px;"><strong>Step 3: Go to People Section</strong><br>
                        In the left sidebar, click "Users" then click "People"</p>
                        
                        <p style="margin-bottom: 12px;"><strong>Step 4: Add New User</strong><br>
                        Click the "Add" button</p>
                        
                        <p style="margin-bottom: 12px;"><strong>Step 5: Enter Our Email</strong><br>
                        Type: <strong id="metaEmailDisplay">Nicolas@driveleadmedia.com</strong></p>
                        
                        <p style="margin-bottom: 12px;"><strong>Step 6: Grant Admin Access</strong><br>
                        Select "Admin" role when prompted for permissions</p>
                        
                        <p style="margin-bottom: 12px;"><strong>Step 7: Send Invitation</strong><br>
                        Click "Invite" to send the access request</p>
                        
                        <p style="margin-bottom: 15px;"><strong>That's it!</strong><br>
                        We'll receive an email notification and accept the invitation. Once accepted, we can begin setting up and managing your advertising campaigns</p>
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <a href="https://business.facebook.com" class="btn" target="_blank" rel="noopener">
                            Open Meta Business Suite
                        </a>
                        <button class="btn btn-outline btn-small" id="metaHelpBtn">
                            Need Help?
                        </button>
                    </div>
                </div>

                <!-- Instructions for users without Business Suite -->
                <div id="newBusinessSuite" style="display: none; background: #FBE9D1; padding: 20px; border-radius: 8px; margin: 15px 0; border: 1px solid #F2A922;">
                    <h5 style="color: #012E40; margin-bottom: 10px;">We'll Help You Set This Up:</h5>
                    <p style="color: #012E40; margin-bottom: 15px;">No worries! Meta Business Suite setup requires a few steps. We'll guide you through it personally.</p>
                    <button class="btn btn-secondary" id="setupHelpBtn">
                        Get Setup Help (5-min call)
                    </button>
                </div>

                <!-- Instructions for unsure users -->
                <div id="unsureBusinessSuiteDiv" style="display: none; background: #F0F9F7; padding: 20px; border-radius: 8px; margin: 15px 0; border: 1px solid #85C7B3;">
                    <h5 style="color: #012E40; margin-bottom: 10px;">Let's Check Together:</h5>
                    <p style="color: #012E40; margin-bottom: 15px;">Not sure if you have Meta Business Suite? We'll help you check and set up access in just a few minutes.</p>
                    <button class="btn" id="checkHelpBtn">
                        Schedule Quick Check (5 mins)
                    </button>
                </div>

                <!-- Brand Kit Upload Section -->
                <div style="margin: 30px 0 20px 0; border-top: 2px solid rgba(133, 199, 179, 0.3); padding-top: 25px;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px; flex-wrap: wrap;">
                        <h4 style="color: #012E40; margin: 0;">üìÅ Brand Kit Upload:</h4>
                        <button class="btn btn-small btn-outline" id="brandKitInfoBtn" style="font-size: 0.8rem; padding: 4px 12px;">
                            What is a brand kit?
                        </button>
                    </div>
                    
                    <!-- Brand Kit Explanation (hidden initially) -->
                    <div id="brandKitInfo" style="display: none; background: #FBE9D1; padding: 20px; border-radius: 8px; margin: 15px 0; border: 1px solid #F2A922;">
                        <h5 style="color: #012E40; margin-bottom: 10px;">Your Brand Kit Should Include:</h5>
                        <div class="brand-kit-grid">
                            <div>
                                <h6 style="color: #012E40; margin-bottom: 8px; font-weight: 600;">üé® Logo Files:</h6>
                                <ul style="margin-left: 15px; color: #012E40; line-height: 1.5;">
                                    <li>High-resolution PNG (transparent background)</li>
                                    <li>White/light version for dark backgrounds (if available)</li>
                                </ul>
                            </div>
                            <div>
                                <h6 style="color: #012E40; margin-bottom: 8px; font-weight: 600;">üåà Color Palette:</h6>
                                <ul style="margin-left: 15px; color: #012E40; line-height: 1.5;">
                                    <li>Brand colors (hex codes like #012E40)</li>
                                    <li>Color palette document or screenshot</li>
                                    <li>Brand guidelines PDF (if available)</li>
                                </ul>
                            </div>
                        </div>
                        <div style="background: #DFF5F3; padding: 15px; border-radius: 6px; border-left: 3px solid #05908C;">
                            <p style="color: #012E40; margin: 0; font-size: 0.9rem;">
                                <strong>üí° Don't have all of these?</strong> No worries! Upload whatever you have. Even just a logo PNG and your main brand colors will help us create ads that match your brand perfectly.
                            </p>
                        </div>
                    </div>

                    <p style="color: #012E40; margin-bottom: 15px;">Upload your logos, brand guidelines, fonts, and any existing creative assets so we can create ads that perfectly match your brand.</p>
                    <a href="#" class="btn btn-outline" id="uploadBtn" data-dlm-event="open_upload" target="_blank" rel="noopener">
                        Upload Brand Assets
                    </a>
                </div>
            </div>
            <button class="btn btn-small skip-step" id="skip3" style="display: none;">Skip Step</button>
        </div>

        <!-- Step 4: Website Access for Tracking -->
        <div class="step locked" id="step4">
            <div class="step-header">
                <div>
                    <h2>Website Access for Tracking</h2>
                    <div class="step-note">We install GA4 and Meta Pixel (no PHI). We handle all technical setup - you just provide access.</div>
                </div>
                <div class="step-number">4</div>
            </div>
            <div class="step-content">
                <div style="margin-bottom: 25px;">
                    <h4 style="color: #012E40; margin-bottom: 15px;">üñ•Ô∏è Website Access Needed</h4>
                    <p style="color: #012E40; margin-bottom: 15px;">Choose the easiest option for you:</p>
                    
                    <div class="radio-group">
                        <div class="radio-item">
                            <input type="radio" id="connectWebAdmin" name="websiteAccess" value="connect">
                            <label for="connectWebAdmin">Connect us with your website admin/developer</label>
                        </div>
                        <div class="radio-item">
                            <input type="radio" id="tempAccess" name="websiteAccess" value="temporary">
                            <label for="tempAccess">Grant us temporary website access</label>
                        </div>
                    </div>
                </div>

                <!-- Connect with website admin -->
                <div id="connectAdminForm" style="display: none; background: #DFF5F3; padding: 20px; border-radius: 8px; margin: 15px 0; border: 1px solid #85C7B3;">
                    <h5 style="color: #012E40; margin-bottom: 10px;">Website Admin Contact:</h5>
                    <div class="form-group">
                        <label for="adminName">Admin/Developer Name</label>
                        <input type="text" id="adminName">
                    </div>
                    <div class="form-group">
                        <label for="adminEmail">Admin Email *</label>
                        <input type="email" id="adminEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="adminPhone">Admin Phone (optional)</label>
                        <input type="tel" id="adminPhone">
                    </div>
                    <div class="form-group">
                        <label for="websitePlatform">Website Platform</label>
                        <select id="websitePlatform">
                            <option value="">Select platform</option>
                            <option value="wordpress">WordPress</option>
                            <option value="squarespace">Squarespace</option>
                            <option value="wix">Wix</option>
                            <option value="shopify">Shopify</option>
                            <option value="webflow">Webflow</option>
                            <option value="other">Other</option>
                        </select>
                        <input type="text" id="websitePlatformOther" placeholder="Please specify..." style="display: none; margin-top: 10px; width: 100%; padding: 12px 16px; border: 2px solid #85C7B3; border-radius: 8px; background: #EEF4D9; color: #012E40;">
                    </div>
                    <p style="font-size: 0.9rem; color: #012E40; margin-top: 10px;">
                        <strong>We'll contact them directly</strong> to coordinate tracking installation.
                    </p>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-small" id="emailAdminInfo">Email Admin Details to Us</button>
                    </div>
                </div>

                <!-- Temporary access form -->
                <div id="tempAccessForm" style="display: none; background: #FBE9D1; padding: 20px; border-radius: 8px; margin: 15px 0; border: 1px solid #F2A922;">
                    <h5 style="color: #012E40; margin-bottom: 10px;">Temporary Website Access:</h5>
                    <div class="form-group">
                        <label for="websiteUrl">Website URL *</label>
                        <input type="url" id="websiteUrl" placeholder="https://yourwebsite.com" required>
                    </div>
                    <div class="form-group">
                        <label for="loginUrl">Login URL</label>
                        <input type="url" id="loginUrl" placeholder="https://yourwebsite.com/wp-admin">
                    </div>
                    <div class="form-group">
                        <label for="tempUsername">Admin Username *</label>
                        <input type="text" id="tempUsername" required>
                    </div>
                    <div class="form-group">
                        <label for="tempPassword">Admin Password *</label>
                        <input type="password" id="tempPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="sitePlatform">Website Platform</label>
                        <select id="sitePlatform">
                            <option value="">Select platform</option>
                            <option value="wordpress">WordPress</option>
                            <option value="squarespace">Squarespace</option>
                            <option value="wix">Wix</option>
                            <option value="shopify">Shopify</option>
                            <option value="webflow">Webflow</option>
                            <option value="other">Other</option>
                        </select>
                        <input type="text" id="sitePlatformOther" placeholder="Please specify..." style="display: none; margin-top: 10px; width: 100%; padding: 12px 16px; border: 2px solid #85C7B3; border-radius: 8px; background: #EEF4D9; color: #012E40;">
                    </div>
                    <p style="font-size: 0.9rem; color: #012E40; margin-top: 10px;">
                        <strong>üîí Secure:</strong> We'll install tracking and remove our access immediately. You can change the password afterward.
                    </p>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-small" id="emailAccessInfo">Send Access Details Securely</button>
                    </div>
                </div>

                <div style="margin-top: 25px; background: #F0F9F7; padding: 15px; border-radius: 8px;">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 10px; flex-wrap: wrap;">
                        <h5 style="color: #012E40; margin: 0;">What We Install:</h5>
                        <button class="btn btn-small btn-outline" id="ga4InfoBtn" style="font-size: 0.8rem; padding: 4px 12px;">
                            What is GA4?
                        </button>
                        <button class="btn btn-small btn-outline" id="pixelInfoBtn" style="font-size: 0.8rem; padding: 4px 12px;">
                            What is Meta Pixel?
                        </button>
                    </div>
                    
                    <!-- GA4 Explanation (hidden initially) -->
                    <div id="ga4Info" style="display: none; background: #DFF5F3; padding: 15px; border-radius: 6px; margin: 10px 0; border: 1px solid #05908C;">
                        <h6 style="color: #012E40; margin-bottom: 8px; font-weight: 600;">Google Analytics 4 (GA4):</h6>
                        <p style="color: #012E40; margin: 0; font-size: 0.9rem; line-height: 1.5;">
                            GA4 tracks how people find and use your website. It shows us which ads bring the most visitors, what pages they look at, and what actions they take (like calling your office or filling out forms). This helps us improve your ads to get better results. <strong>No personal health information is tracked.</strong>
                        </p>
                    </div>

                    <!-- Meta Pixel Explanation (hidden initially) -->
                    <div id="pixelInfo" style="display: none; background: #FBE9D1; padding: 15px; border-radius: 6px; margin: 10px 0; border: 1px solid #F2A922;">
                        <h6 style="color: #012E40; margin-bottom: 8px; font-weight: 600;">Meta Pixel (Facebook/Instagram):</h6>
                        <p style="color: #012E40; margin: 0; font-size: 0.9rem; line-height: 1.5;">
                            Meta Pixel tracks when people visit your website after seeing your Facebook or Instagram ads. It helps us find more people similar to your best customers and shows ads to people who visited your website but didn't book an appointment yet. <strong>No personal health information is tracked.</strong>
                        </p>
                    </div>

                    <ul style="margin-left: 20px; color: #012E40; line-height: 1.6;">
                        <li>‚úì Google Analytics 4 (GA4) tracking code</li>
                        <li>‚úì Meta Pixel tracking code</li>
                        <li>‚úì Conversion tracking setup</li>
                        <li>‚úì Testing to ensure everything works</li>
                    </ul>
                    <p style="font-size: 0.9rem; color: #012E40; margin-top: 10px;">
                        <strong>Timeline:</strong> Completed within 7 days of receiving access.
                    </p>
                </div>
            </div>
            <button class="btn btn-small skip-step" id="skip4" style="display: none;">Skip Step</button>
        </div>

        <!-- Step 5: Creative Approval -->
        <div class="step locked" id="step5">
            <div class="step-header">
                <div>
                    <h2>Creative Approval</h2>
                    <div class="step-note">Your Launch Creative Bundle: 1 actor-led video, 1 animated video, 2 image ads.</div>
                </div>
                <div class="step-number">5</div>
            </div>
            <div class="step-content">
                <div class="gallery-placeholder" id="galleryPlaceholder">
                    <p>Creative previews will be shared via secure link</p>
                    <p style="font-size: 0.9rem; color: #85C7B3; margin-top: 10px;">
                        Links will be provided once creatives are ready for review
                    </p>
                </div>
                <div style="margin: 20px 0;">
                    <button class="btn" id="approveBtn" data-dlm-event="approve_launch">
                        Approve to Launch
                    </button>
                    <button class="btn btn-outline" id="revisionBtn" data-dlm-event="request_revisions">
                        Request Revisions
                    </button>
                </div>

                <!-- Revision form (hidden initially) -->
                <div id="revisionForm" style="display: none; background: #DFF5F3; padding: 20px; border-radius: 8px; margin-top: 15px; border: 1px solid #85C7B3;">
                    <h4 style="color: #012E40;">Request Revisions</h4>
                    <div class="form-group">
                        <label for="revisionName">Name *</label>
                        <input type="text" id="revisionName" required>
                    </div>
                    <div class="form-group">
                        <label for="revisionEmail">Email *</label>
                        <input type="email" id="revisionEmail" required>
                    </div>
                    <div class="form-group">
                        <label for="revisionNotes">Revision Notes *</label>
                        <textarea id="revisionNotes" rows="4" placeholder="Please describe the changes you'd like to see..." required></textarea>
                    </div>
                    <div style="margin: 15px 0;">
                        <button class="btn btn-small" id="copyRevision">Copy to Clipboard</button>
                        <button class="btn btn-small btn-outline" id="emailRevision">Email Revisions</button>
                    </div>
                </div>
            </div>
            <button class="btn btn-small skip-step" id="skip5" style="display: none;">Skip Step</button>
        </div>

        <!-- Footer -->
        <div class="portal-footer">
            <p>Drive Lead Media ‚Äî We never process PHI. All analytics used solely to measure and improve advertising performance.</p>
            <div class="footer-links">
                <a href="#" id="resetProgress">Reset progress</a>
                <span>‚Ä¢</span>
                <span id="contactEmail">Nicolas@driveleadmedia.com</span>
                <span>‚Ä¢</span>
                <span id="contactPhone">(678) 650-6411</span>
            </div>
        </div>
    </div>

    <script>
        // ===== GLOBAL FUNCTIONS (ACCESSIBLE FROM ONCLICK) =====
        window.DLM_CONFIG = {
            docuSign: {
                msa: "https://na4.docusign.net/Member/PowerFormSigning.aspx?PowerFormId=a78e28e4-f9a0-4e5a-8795-d31c45721130&env=na4&acct=ab9821cd-da5d-4091-8f74-e8602b87929d&v=2",
                dpa: "https://na4.docusign.net/Member/PowerFormSigning.aspx?PowerFormId=143e9c27-bc1d-4f0e-aab5-65a344a4f3e3&env=na4&acct=ab9821cd-da5d-4091-8f74-e8602b87929d&v=2",
                sow6: "https://na4.docusign.net/Member/PowerFormSigning.aspx?PowerFormId=a135e495-2882-46e5-96b0-c91d4498d030&env=na4&acct=ab9821cd-da5d-4091-8f74-e8602b87929d&v=2",
                sow12: "https://na4.docusign.net/Member/PowerFormSigning.aspx?PowerFormId=7894201c-9ab2-4d7e-8126-18094731fd82&env=na4&acct=ab9821cd-da5d-4091-8f74-e8602b87929d&v=2"
            },
            stripeUrl: "https://stripe-payment-link",
            uploads: {
                driveFileRequestUrl: "https://drive.google.com/drive/folders/1jds7K6SdV6G_SwTyZZjxqjuftqIHiaPY?usp=sharing"
            },
            tracking: {
                ga4MeasurementId: "G-XXXXXXX",
                pixelId: "1234567890"
            },
            support: {
                opsEmail: "Nicolas@driveleadmedia.com",
                opsPhone: "(678) 650-6411",
                webhookUrl: ""
            },
            admin: {
                password: "dlm2024",
                sessionTimeout: 30 * 60 * 1000
            }
        };

        window.STORAGE_KEY = 'dlm_portal_v1';
        window.portalState = {
            "1": false,
            "2": false,
            "3": false,
            "4": false,
            "5": false,
            "admin": {},
            "creativeLink": null,
            "stripePaymentLink": null
        };

        // ===== ADMIN FUNCTIONS =====
        window.toggleAdminPanel = function() {
            console.log('Admin panel toggle clicked!');
            const panel = document.getElementById('adminPanel');
            const isVisible = panel.style.display !== 'none';
            
            if (isVisible) {
                panel.style.display = 'none';
            } else {
                panel.style.display = 'block';
                
                // Check if already logged in
                if (window.isAdminLoggedIn()) {
                    document.getElementById('adminControls').style.display = 'block';
                    document.getElementById('adminLogin').style.display = 'none';
                    
                    // Load existing links
                    const existingCreativeLink = window.portalState.creativeLink;
                    if (existingCreativeLink) {
                        document.getElementById('creativeLink').value = existingCreativeLink;
                    }
                    
                    const existingStripeLink = window.portalState.stripePaymentLink;
                    if (existingStripeLink) {
                        document.getElementById('stripePaymentLink').value = existingStripeLink;
                    }
                } else {
                    document.getElementById('adminControls').style.display = 'none';
                    document.getElementById('adminLogin').style.display = 'block';
                    document.getElementById('adminPassword').value = '';
                }
            }
        };

        window.isAdminLoggedIn = function() {
            const loginTime = localStorage.getItem('dlm_admin_login');
            if (!loginTime) return false;
            
            const now = Date.now();
            const elapsed = now - parseInt(loginTime);
            
            if (elapsed > window.DLM_CONFIG.admin.sessionTimeout) {
                localStorage.removeItem('dlm_admin_login');
                return false;
            }
            
            return true;
        };

        window.adminLogin = function() {
            console.log('Admin login attempted');
            const password = document.getElementById('adminPassword').value;
            
            if (password === window.DLM_CONFIG.admin.password) {
                localStorage.setItem('dlm_admin_login', Date.now().toString());
                document.getElementById('adminControls').style.display = 'block';
                document.getElementById('adminLogin').style.display = 'none';
                
                // Load existing links
                const existingCreativeLink = window.portalState.creativeLink;
                if (existingCreativeLink) {
                    document.getElementById('creativeLink').value = existingCreativeLink;
                }
                
                const existingStripeLink = window.portalState.stripePaymentLink;
                if (existingStripeLink) {
                    document.getElementById('stripePaymentLink').value = existingStripeLink;
                }
                
                window.showAdminStatus('‚úì Admin logged in', 'success');
            } else {
                window.showAdminStatus('‚úó Invalid password', 'error');
                document.getElementById('adminPassword').value = '';
            }
        };

        window.showAdminStatus = function(message, type) {
            const status = document.getElementById('adminStatus');
            status.textContent = message;
            status.className = `admin-status ${type}`;
            status.style.display = 'block';
            
            setTimeout(() => {
                status.style.display = 'none';
            }, 3000);
        };

        window.setCreativeLink = function() {
            const link = document.getElementById('creativeLink').value.trim();
            
            if (!link) {
                window.showAdminStatus('‚úó Please enter a link', 'error');
                return;
            }
            
            try {
                new URL(link);
            } catch {
                window.showAdminStatus('‚úó Please enter a valid URL', 'error');
                return;
            }
            
            window.portalState.creativeLink = link;
            window.saveState();
            window.updateCreativeGallery(link);
            window.showAdminStatus('‚úì Creative link set successfully', 'success');
        };

        window.removeCreativeLink = function() {
            window.portalState.creativeLink = null;
            window.saveState();
            window.updateCreativeGallery(null);
            document.getElementById('creativeLink').value = '';
            window.showAdminStatus('‚úì Creative link removed', 'success');
        };

        window.setStripeLink = function() {
            const link = document.getElementById('stripePaymentLink').value.trim();
            
            if (!link) {
                window.showAdminStatus('‚úó Please enter a Stripe link', 'error');
                return;
            }
            
            try {
                new URL(link);
            } catch {
                window.showAdminStatus('‚úó Please enter a valid URL', 'error');
                return;
            }
            
            window.portalState.stripePaymentLink = link;
            window.saveState();
            window.updateStripeButton(link);
            window.showAdminStatus('‚úì Stripe link set successfully', 'success');
        };

        window.removeStripeLink = function() {
            window.portalState.stripePaymentLink = null;
            window.saveState();
            window.updateStripeButton(window.DLM_CONFIG.stripeUrl);
            document.getElementById('stripePaymentLink').value = '';
            window.showAdminStatus('‚úì Stripe link removed (reset to default)', 'success');
        };

        window.updateStripeButton = function(link) {
            const stripeBtn = document.getElementById('stripeBtn');
            stripeBtn.href = link;
        };

        window.updateCreativeGallery = function(link) {
            const gallery = document.getElementById('galleryPlaceholder');
            
            if (link) {
                gallery.innerHTML = `
                    <div style="text-align: center;">
                        <p style="color: #012E40; margin-bottom: 15px; font-weight: 600;">üé® Your Creative Previews Are Ready!</p>
                        <a href="${link}" class="btn" target="_blank" rel="noopener" style="margin-bottom: 15px;">
                            View Creative Previews
                        </a>
                        <p style="font-size: 0.9rem; color: #85C7B3;">
                            Review all creatives, then return here to approve or request changes
                        </p>
                    </div>
                `;
            } else {
                gallery.innerHTML = `
                    <p>Creative previews will be shared via secure link</p>
                    <p style="font-size: 0.9rem; color: #85C7B3; margin-top: 10px;">
                        Links will be provided once creatives are ready for review
                    </p>
                `;
            }
        };

        // ===== UTILITY FUNCTIONS =====
        window.loadState = function() {
            try {
                const saved = localStorage.getItem(window.STORAGE_KEY);
                if (saved) {
                    window.portalState = { ...window.portalState, ...JSON.parse(saved) };
                }
            } catch (e) {
                console.warn('Could not load portal state:', e);
            }
        };

        window.saveState = function() {
            try {
                localStorage.setItem(window.STORAGE_KEY, JSON.stringify(window.portalState));
            } catch (e) {
                console.warn('Could not save portal state:', e);
            }
        };

        window.updateStepStates = function() {
            for (let i = 1; i <= 5; i++) {
                const stepElement = document.getElementById(`step${i}`);
                const isCompleted = window.portalState[i.toString()];
                const isUnlocked = i === 1 || window.portalState[(i - 1).toString()];
                
                stepElement.classList.toggle('completed', isCompleted);
                stepElement.classList.toggle('locked', !isUnlocked);
            }
        };

        window.showSuccessMessage = function() {
            document.getElementById('successMessage').style.display = 'block';
            document.getElementById('successMessage').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'center' 
            });
        };

        window.markStepComplete = function(stepNum) {
            window.portalState[stepNum.toString()] = true;
            window.saveState();
            window.updateStepStates();
            
            // Check if all steps are complete
            const allComplete = Object.keys(window.portalState).filter(key => 
                key !== 'admin' && key !== 'creativeLink' && key !== 'stripePaymentLink' && window.portalState[key]
            ).length === 5;
            
            if (allComplete) {
                window.showSuccessMessage();
            }
            
            if (window.DLM_CONFIG.support.webhookUrl) {
                window.sendWebhook({
                    step: stepNum,
                    completedAt: new Date().toISOString(),
                    action: 'step_completed'
                });
            }
        };

        // ===== SOW BUTTON UPDATE FUNCTION =====
        window.updateSOWButton = function() {
            const sow6Radio = document.getElementById('sow6');
            const sow12Radio = document.getElementById('sow12');
            const sowBtn = document.getElementById('sowBtn');
            
            if (sow12Radio && sow12Radio.checked) {
                sowBtn.textContent = 'Sign SOW (12-month)';
                sowBtn.href = window.DLM_CONFIG.docuSign.sow12;
            } else {
                sowBtn.textContent = 'Sign SOW (6-month)';
                sowBtn.href = window.DLM_CONFIG.docuSign.sow6;
            }
        };

        // ===== EMAIL FUNCTIONS =====
        window.emailAdminDetails = function() {
            const adminName = document.getElementById('adminName').value;
            const adminEmail = document.getElementById('adminEmail').value;
            const adminPhone = document.getElementById('adminPhone').value;
            const platform = document.getElementById('websitePlatform').value;
            const platformOther = document.getElementById('websitePlatformOther').value;
            
            if (!adminEmail) {
                alert('Please enter admin email address');
                return;
            }
            
            const platformText = platform === 'other' ? platformOther : platform;
            const subject = 'Website Admin Contact Details - Client Portal';
            const body = `Website Admin Contact Details:

Name: ${adminName || 'Not provided'}
Email: ${adminEmail}
Phone: ${adminPhone || 'Not provided'}
Platform: ${platformText || 'Not specified'}

Please contact them to coordinate tracking installation.`;

            const mailtoLink = `mailto:${window.DLM_CONFIG.support.opsEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(mailtoLink);
        };

        window.emailAccessDetails = function() {
            const websiteUrl = document.getElementById('websiteUrl').value;
            const loginUrl = document.getElementById('loginUrl').value;
            const username = document.getElementById('tempUsername').value;
            const password = document.getElementById('tempPassword').value;
            const platform = document.getElementById('sitePlatform').value;
            const platformOther = document.getElementById('sitePlatformOther').value;
            
            if (!websiteUrl || !username || !password) {
                alert('Please fill in all required fields');
                return;
            }
            
            const platformText = platform === 'other' ? platformOther : platform;
            const subject = 'Temporary Website Access Details - Client Portal';
            const body = `Temporary Website Access Details:

Website URL: ${websiteUrl}
Login URL: ${loginUrl || 'Not provided'}
Username: ${username}
Password: ${password}
Platform: ${platformText || 'Not specified'}

Please install tracking and remove access when complete.`;

            const mailtoLink = `mailto:${window.DLM_CONFIG.support.opsEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(mailtoLink);
        };

        window.emailRevisionRequest = function() {
            const name = document.getElementById('revisionName').value;
            const email = document.getElementById('revisionEmail').value;
            const notes = document.getElementById('revisionNotes').value;
            
            if (!name || !email || !notes) {
                alert('Please fill in all required fields');
                return;
            }
            
            const subject = 'Creative Revision Request - Client Portal';
            const body = `Creative Revision Request:

Client Name: ${name}
Client Email: ${email}

Revision Notes:
${notes}`;

            const mailtoLink = `mailto:${window.DLM_CONFIG.support.opsEmail}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(mailtoLink);
        };

        // ===== COPY TO CLIPBOARD FUNCTION =====
        window.copyRevisionToClipboard = function() {
            const name = document.getElementById('revisionName').value;
            const email = document.getElementById('revisionEmail').value;
            const notes = document.getElementById('revisionNotes').value;
            
            if (!name || !email || !notes) {
                alert('Please fill in all required fields');
                return;
            }
            
            const text = `Creative Revision Request:

Client Name: ${name}
Client Email: ${email}

Revision Notes:
${notes}`;

            if (navigator.clipboard) {
                navigator.clipboard.writeText(text).then(() => {
                    alert('Revision details copied to clipboard!');
                }).catch(() => {
                    fallbackCopyToClipboard(text);
                });
            } else {
                fallbackCopyToClipboard(text);
            }
        };

        function fallbackCopyToClipboard(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                alert('Revision details copied to clipboard!');
            } catch (err) {
                alert('Could not copy to clipboard. Please copy manually.');
            }
            document.body.removeChild(textArea);
        }

        // ===== WEBHOOK FUNCTION =====
        window.sendWebhook = function(data) {
            if (!window.DLM_CONFIG.support.webhookUrl) return;
            
            fetch(window.DLM_CONFIG.support.webhookUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).catch(err => {
                console.warn('Webhook failed:', err);
            });
        };

        // ===== RESET PROGRESS FUNCTION =====
        window.resetProgress = function() {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                localStorage.removeItem(window.STORAGE_KEY);
                localStorage.removeItem('dlm_admin_login');
                location.reload();
            }
        };

        // ===== SETUP ALL EVENT LISTENERS =====
        window.setupEventListeners = function() {
            // SOW term selection
            const sowRadios = document.querySelectorAll('input[name="sowTerm"]');
            sowRadios.forEach(radio => {
                radio.addEventListener('change', window.updateSOWButton);
            });

            // Meta setup options
            const metaRadios = document.querySelectorAll('input[name="metaSetup"]');
            metaRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    // Hide all forms first
                    document.getElementById('existingBusinessSuite').style.display = 'none';
                    document.getElementById('newBusinessSuite').style.display = 'none';
                    document.getElementById('unsureBusinessSuiteDiv').style.display = 'none';
                    
                    // Show appropriate form
                    if (this.value === 'yes') {
                        document.getElementById('existingBusinessSuite').style.display = 'block';
                    } else if (this.value === 'no') {
                        document.getElementById('newBusinessSuite').style.display = 'block';
                    } else if (this.value === 'unsure') {
                        document.getElementById('unsureBusinessSuiteDiv').style.display = 'block';
                    }
                });
            });

            // Website access options
            const websiteRadios = document.querySelectorAll('input[name="websiteAccess"]');
            websiteRadios.forEach(radio => {
                radio.addEventListener('change', function() {
                    // Hide all forms first
                    document.getElementById('connectAdminForm').style.display = 'none';
                    document.getElementById('tempAccessForm').style.display = 'none';
                    
                    // Show appropriate form
                    if (this.value === 'connect') {
                        document.getElementById('connectAdminForm').style.display = 'block';
                    } else if (this.value === 'temporary') {
                        document.getElementById('tempAccessForm').style.display = 'block';
                    }
                });
            });

            // Platform selection handlers
            const platformSelects = [
                { select: 'websitePlatform', other: 'websitePlatformOther' },
                { select: 'sitePlatform', other: 'sitePlatformOther' }
            ];
            
            platformSelects.forEach(({ select, other }) => {
                const selectElement = document.getElementById(select);
                const otherInput = document.getElementById(other);
                
                if (selectElement && otherInput) {
                    selectElement.addEventListener('change', function() {
                        if (this.value === 'other') {
                            otherInput.style.display = 'block';
                            otherInput.required = true;
                        } else {
                            otherInput.style.display = 'none';
                            otherInput.required = false;
                            otherInput.value = '';
                        }
                    });
                }
            });

            // Info button toggles
            const infoButtons = [
                { btn: 'brandKitInfoBtn', info: 'brandKitInfo' },
                { btn: 'ga4InfoBtn', info: 'ga4Info' },
                { btn: 'pixelInfoBtn', info: 'pixelInfo' }
            ];

            infoButtons.forEach(({ btn, info }) => {
                const button = document.getElementById(btn);
                const infoDiv = document.getElementById(info);
                
                if (button && infoDiv) {
                    button.addEventListener('click', function(e) {
                        e.preventDefault();
                        const isVisible = infoDiv.style.display !== 'none';
                        infoDiv.style.display = isVisible ? 'none' : 'block';
                    });
                }
            });

            // Revision form toggle
            const revisionBtn = document.getElementById('revisionBtn');
            const revisionForm = document.getElementById('revisionForm');
            
            if (revisionBtn && revisionForm) {
                revisionBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    const isVisible = revisionForm.style.display !== 'none';
                    revisionForm.style.display = isVisible ? 'none' : 'block';
                });
            }

            // Email and copy buttons
            const emailAdminBtn = document.getElementById('emailAdminInfo');
            if (emailAdminBtn) {
                emailAdminBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    window.emailAdminDetails();
                });
            }

            const emailAccessBtn = document.getElementById('emailAccessInfo');
            if (emailAccessBtn) {
                emailAccessBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    window.emailAccessDetails();
                });
            }

            const emailRevisionBtn = document.getElementById('emailRevision');
            if (emailRevisionBtn) {
                emailRevisionBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    window.emailRevisionRequest();
                });
            }

            const copyRevisionBtn = document.getElementById('copyRevision');
            if (copyRevisionBtn) {
                copyRevisionBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    window.copyRevisionToClipboard();
                });
            }

            // Reset progress
            const resetBtn = document.getElementById('resetProgress');
            if (resetBtn) {
                resetBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    window.resetProgress();
                });
            }

            // Help buttons
            const helpButtons = ['metaHelpBtn', 'setupHelpBtn', 'checkHelpBtn'];
            helpButtons.forEach(btnId => {
                const btn = document.getElementById(btnId);
                if (btn) {
                    btn.addEventListener('click', function(e) {
                        e.preventDefault();
                        const mailtoLink = `mailto:${window.DLM_CONFIG.support.opsEmail}?subject=Need Help with Meta Business Suite Setup`;
                        window.open(mailtoLink);
                    });
                }
            });

            // Approve button
            const approveBtn = document.getElementById('approveBtn');
            if (approveBtn) {
                approveBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    if (confirm('Are you sure you want to approve these creatives for launch?')) {
                        window.markStepComplete(5);
                        alert('Creatives approved! Your campaign will launch within 24-48 hours.');
                    }
                });
            }
        };

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Portal initializing...');
            
            // Load state first
            window.loadState();
            
            // Initialize external links
            document.getElementById('msaBtn').href = window.DLM_CONFIG.docuSign.msa;
            document.getElementById('dpaBtn').href = window.DLM_CONFIG.docuSign.dpa;
            document.getElementById('uploadBtn').href = window.DLM_CONFIG.uploads.driveFileRequestUrl;
            
            // Set Stripe URL
            const stripeLink = window.portalState.stripePaymentLink || window.DLM_CONFIG.stripeUrl;
            document.getElementById('stripeBtn').href = stripeLink;
            
            // Initialize SOW button
            window.updateSOWButton();
            
            // Display config values
            document.getElementById('metaEmailDisplay').textContent = window.DLM_CONFIG.support.opsEmail;
            document.getElementById('contactEmail').textContent = window.DLM_CONFIG.support.opsEmail;
            document.getElementById('contactPhone').textContent = window.DLM_CONFIG.support.opsPhone;
            
            // Initialize UI
            window.updateStepStates();
            
            // Initialize creative gallery
            if (window.portalState.creativeLink) {
                window.updateCreativeGallery(window.portalState.creativeLink);
            }
            
            // Setup all event listeners
            window.setupEventListeners();
            
            // Password field Enter key
            document.getElementById('adminPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    window.adminLogin();
                }
            });
            
            console.log('Portal initialization complete!');
        });

        // Close admin panel when clicking outside
        document.addEventListener('click', function(e) {
            const panel = document.getElementById('adminPanel');
            const toggle = document.getElementById('adminToggle');
            
            if (!panel.contains(e.target) && !toggle.contains(e.target)) {
                panel.style.display = 'none';
            }
        });
    </script>
</body>
</html>